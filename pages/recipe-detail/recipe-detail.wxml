<!--pages/recipe-detail/recipe-detail.wxml-->
<view class="container" wx:if="{{recipe}}">
  <!-- å¤´éƒ¨å›¾ç‰‡ -->
  <view class="header-image-wrap">
    <image 
      class="header-image" 
      src="{{recipe.image}}" 
      mode="aspectFill"
      wx:if="{{recipe.image}}"
    />
    <view class="header-image-placeholder" wx:else>ğŸ²</view>
    <view class="header-overlay">
      <view class="recipe-title">{{recipe.name}}</view>
      <view class="recipe-subtitle">{{recipe.description}}</view>
    </view>
  </view>

  <!-- åŸºæœ¬ä¿¡æ¯ -->
  <view class="info-cards">
    <view class="info-card">
      <view class="info-value">{{recipe.prepTime}}</view>
      <view class="info-label">åˆ¶ä½œæ—¶é—´</view>
    </view>
    <view class="info-card">
      <view class="info-value">{{recipe.difficulty}}</view>
      <view class="info-label">éš¾åº¦</view>
    </view>
    <view class="info-card">
      <view class="info-value">{{recipe.calories}}</view>
      <view class="info-label">çƒ­é‡</view>
    </view>
  </view>

  <!-- é€‚ç”¨è¯´æ˜ -->
  <view class="suitable-section card" wx:if="{{recipe.suitableFor.length > 0}}">
    <view class="suitable-title">é€‚ç”¨äº</view>
    <view class="suitable-tags">
      <view class="suitable-tag" wx:for="{{recipe.suitableFor}}" wx:key="*this">
        {{item}}
      </view>
    </view>
  </view>

  <!-- æ ‡ç­¾é¡µ -->
  <view class="tabs">
    <view 
      class="tab {{activeTab === 'ingredients' ? 'active' : ''}}" 
      data-tab="ingredients"
      bindtap="onTabChange"
    >é£Ÿææ¸…å•</view>
    <view 
      class="tab {{activeTab === 'steps' ? 'active' : ''}}" 
      data-tab="steps"
      bindtap="onTabChange"
    >åˆ¶ä½œæ­¥éª¤</view>
    <view 
      class="tab {{activeTab === 'nutrition' ? 'active' : ''}}" 
      data-tab="nutrition"
      bindtap="onTabChange"
    >è¥å…»è¯´æ˜</view>
  </view>

  <!-- é£Ÿææ¸…å• -->
  <view class="tab-content card" wx:if="{{activeTab === 'ingredients'}}">
    <view class="ingredient-list">
      <view class="ingredient-item" wx:for="{{recipe.ingredients}}" wx:key="name">
        <view class="ingredient-name">{{item.name}}</view>
        <view class="ingredient-right">
          <text class="ingredient-amount">{{item.amount}}</text>
          <text class="ingredient-note" wx:if="{{item.note}}">{{item.note}}</text>
        </view>
      </view>
    </view>
    <view class="servings-note">
      ä»½é‡è¯´æ˜ï¼š{{recipe.servings}}
    </view>
  </view>

  <!-- åˆ¶ä½œæ­¥éª¤ -->
  <view class="tab-content card" wx:if="{{activeTab === 'steps'}}">
    <view class="step-list">
      <view class="step-item" wx:for="{{recipe.steps}}" wx:key="*this">
        <view class="step-number">{{index + 1}}</view>
        <view class="step-content">{{item}}</view>
      </view>
    </view>
  </view>

  <!-- è¥å…»è¯´æ˜ -->
  <view class="tab-content card" wx:if="{{activeTab === 'nutrition'}}">
    <view class="nutrition-grid">
      <view class="nutrition-item">
        <view class="nutrition-label">è›‹ç™½è´¨</view>
        <view class="nutrition-value">{{recipe.nutrition.protein}}</view>
      </view>
      <view class="nutrition-item">
        <view class="nutrition-label">è„‚è‚ª</view>
        <view class="nutrition-value">{{recipe.nutrition.fat}}</view>
      </view>
      <view class="nutrition-item">
        <view class="nutrition-label">çº¤ç»´ç´ </view>
        <view class="nutrition-value">{{recipe.nutrition.fiber}}</view>
      </view>
    </view>
    <view class="nutrition-special" wx:if="{{recipe.nutrition.special}}">
      <view class="special-title">ç‰¹åˆ«è¯´æ˜</view>
      <view class="special-content">{{recipe.nutrition.special}}</view>
    </view>
  </view>

  <!-- å°è´´å£« -->
  <view class="tips-section card" wx:if="{{recipe.tips.length > 0}}">
    <view class="section-title tips-title">
      <text class="tips-icon">ğŸ’¡</text>
      <text>å°è´´å£«</text>
    </view>
    <view class="tips-list">
      <view class="tip-item" wx:for="{{recipe.tips}}" wx:key="*this">
        {{item}}
      </view>
    </view>
  </view>

  <!-- æ³¨æ„äº‹é¡¹ -->
  <view class="warnings-section card" wx:if="{{recipe.warnings.length > 0}}">
    <view class="section-title warnings-title">
      <text class="warnings-icon">âš ï¸</text>
      <text>æ³¨æ„äº‹é¡¹</text>
    </view>
    <view class="warnings-list">
      <view class="warning-item" wx:for="{{recipe.warnings}}" wx:key="*this">
        {{item}}
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-bar safe-bottom">
    <button class="action-btn" bindtap="onCollect">
      <text class="btn-icon">â¤ï¸</text>
      <text>æ”¶è—</text>
    </button>
    <button class="action-btn share-btn" open-type="share">
      <text class="btn-icon">â†—ï¸</text>
      <text>åˆ†äº«</text>
    </button>
  </view>
</view>

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading-state" wx:if="{{!recipe}}">
  <text>åŠ è½½ä¸­...</text>
</view>
