<!--pages/pet-detail/pet-detail.wxml-->
<view class="container" wx:if="{{pet}}">
  <!-- å® ç‰©åŸºæœ¬ä¿¡æ¯ -->
  <view class="profile-section">
    <view class="profile-row">
      <view class="avatar-wrap">
        <image class="avatar" src="{{pet.avatar}}" mode="aspectFill" wx:if="{{pet.avatar}}"/>
        <view class="avatar-placeholder" wx:else>ğŸ•</view>
      </view>
      <view class="profile-info">
        <view class="profile-name">{{pet.name}}</view>
        <view class="profile-detail-text">{{pet.breedName || 'æœªçŸ¥å“ç§'}}</view>
        <view class="profile-detail-text">{{pet.age}}å² Â· {{pet.gender === 'male' ? 'å…¬' : pet.gender === 'female' ? 'æ¯' : 'æœªçŸ¥'}} Â· {{pet.weight || '?'}}kg</view>
      </view>
    </view>

    <!-- å¥åº·çŠ¶æ€æ ‡ç­¾ -->
    <view class="health-status-badge {{diseaseNames.length > 0 ? 'warning' : 'good'}}">
      <text class="badge-icon">â™¥</text>
      <text>å¥åº·çŠ¶æ€ï¼š{{diseaseNames.length > 0 ? 'éœ€å…³æ³¨' : 'è‰¯å¥½'}}</text>
    </view>
  </view>

  <!-- è¿‡æ•å² -->
  <view class="detail-card" wx:if="{{allergenNames.length > 0}}">
    <view class="card-header">
      <view class="card-icon-box red">
        <text class="card-icon-text">âš </text>
      </view>
      <text class="card-header-title">è¿‡æ•å²</text>
    </view>
    <view class="tag-wrap">
      <view class="tag red" wx:for="{{allergenNames}}" wx:key="*this">{{item}}</view>
    </view>
  </view>

  <!-- å¥åº·çŠ¶å†µ -->
  <view class="detail-card" wx:if="{{diseaseNames.length > 0}}">
    <view class="card-header">
      <view class="card-icon-box orange">
        <text class="card-icon-text">â™¥</text>
      </view>
      <text class="card-header-title">å¥åº·çŠ¶å†µ</text>
    </view>
    <view class="condition-list">
      <view class="condition-item" wx:for="{{diseaseNames}}" wx:key="*this">
        <view class="condition-dot"></view>
        <text class="condition-text">{{item}}</text>
      </view>
    </view>
  </view>

  <!-- ç”¨è¯æƒ…å†µ -->
  <view class="detail-card" wx:if="{{pet.medications}}">
    <view class="card-header">
      <view class="card-icon-box blue">
        <text class="card-icon-text">ğŸ’Š</text>
      </view>
      <text class="card-header-title">ç”¨è¯æƒ…å†µ</text>
    </view>
    <view class="med-card">
      <text class="med-text">{{pet.medications}}</text>
    </view>
  </view>

  <!-- æœ€è¿‘ä½“æ£€ -->
  <view class="detail-card">
    <view class="card-header">
      <view class="card-icon-box purple">
        <text class="card-icon-text">ğŸ“…</text>
      </view>
      <text class="card-header-title">æœ€è¿‘ä½“æ£€</text>
    </view>
    <text class="detail-plain-text" wx:if="{{pet.lastCheckupDate}}">{{pet.lastCheckupDate}}</text>
    <view class="checkup-hint" wx:if="{{!pet.lastCheckupDate}}">
      <text class="hint-icon">ğŸ’¡</text>
      <text class="hint-text">è¿˜æ²¡æœ‰è®°å½•ä½“æ£€æ—¥æœŸï¼Œè®°å¾—å¸¦TAå»ä½“æ£€å“¦</text>
    </view>
    <view class="report-grid" wx:if="{{pet.reports && pet.reports.length > 0}}">
      <image
        class="report-thumb"
        wx:for="{{pet.reports}}"
        wx:key="id"
        src="{{item.path}}"
        mode="aspectFill"
        bindtap="onPreviewReport"
        data-index="{{index}}"
      />
    </view>
  </view>

  <!-- æŠ¤ç†å¤‡æ³¨ -->
  <view class="detail-card" wx:if="{{pet.preferences || pet.currentDiet || pet.activityLevel}}">
    <view class="card-header">
      <view class="card-icon-box green">
        <text class="card-icon-text">ğŸ“</text>
      </view>
      <text class="card-header-title">æŠ¤ç†å¤‡æ³¨</text>
    </view>
    <view class="notes-section" wx:if="{{pet.activityLevel}}">
      <text class="notes-label">æ´»åŠ¨èƒ½åŠ›ï¼š</text>
      <text class="notes-text">{{activityText}}</text>
    </view>
    <view class="notes-section" wx:if="{{pet.preferences}}">
      <text class="notes-label">å£å‘³åå¥½ï¼š</text>
      <text class="notes-text">{{pet.preferences}}</text>
    </view>
    <view class="notes-section" wx:if="{{pet.currentDiet}}">
      <text class="notes-label">å½“å‰é¥®é£Ÿï¼š</text>
      <text class="notes-text">{{pet.currentDiet}}</text>
    </view>
  </view>

  <!-- æ¨èé£Ÿè°±æŒ‰é’® -->
  <view class="action-wrap">
    <button class="recipe-cta" bindtap="onViewRecipes">æŸ¥çœ‹æ¨èé£Ÿè°±</button>
  </view>

  <!-- ç¼–è¾‘å’Œåˆ é™¤ -->
  <view class="secondary-actions">
    <button class="edit-btn" bindtap="onEdit">ç¼–è¾‘æ¡£æ¡ˆ</button>
    <button class="delete-btn" bindtap="onDelete">åˆ é™¤æ¡£æ¡ˆ</button>
  </view>
</view>
