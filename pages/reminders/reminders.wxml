<!--pages/reminders/reminders.wxml-->
<view class="container">
  <!-- å–‚é£Ÿæé†’ -->
  <view class="section">
    <view class="section-header">
      <text class="section-icon">ğŸ½</text>
      <text class="section-title">å–‚é£Ÿæé†’</text>
    </view>
    <view class="reminder-list" wx:if="{{feedingReminders.length > 0}}">
      <view class="reminder-item" wx:for="{{feedingReminders}}" wx:key="id">
        <view class="reminder-info">
          <view class="reminder-time">{{item.time}}</view>
          <view class="reminder-detail">
            <text class="reminder-title">{{item.title}}</text>
            <text class="reminder-pet" wx:if="{{item.petName}}">Â· {{item.petName}}</text>
          </view>
          <view class="reminder-repeat">{{item.repeat === 'daily' ? 'æ¯å¤©' : 'ä»…ä¸€æ¬¡'}}</view>
        </view>
        <view class="reminder-actions">
          <switch checked="{{item.enabled}}" bindchange="onToggle" data-id="{{item.id}}" color="#f97316" />
          <view class="delete-btn" bindtap="onDelete" data-id="{{item.id}}">åˆ é™¤</view>
        </view>
      </view>
    </view>
    <view class="empty-hint" wx:else>æš‚æ— å–‚é£Ÿæé†’</view>
  </view>

  <!-- ç”¨è¯æé†’ -->
  <view class="section">
    <view class="section-header">
      <text class="section-icon">ğŸ’Š</text>
      <text class="section-title">ç”¨è¯æé†’</text>
    </view>
    <view class="reminder-list" wx:if="{{medicationReminders.length > 0}}">
      <view class="reminder-item" wx:for="{{medicationReminders}}" wx:key="id">
        <view class="reminder-info">
          <view class="reminder-time">{{item.time}}</view>
          <view class="reminder-detail">
            <text class="reminder-title">{{item.title}}</text>
            <text class="reminder-pet" wx:if="{{item.petName}}">Â· {{item.petName}}</text>
          </view>
          <view class="reminder-repeat">{{item.repeat === 'daily' ? 'æ¯å¤©' : 'ä»…ä¸€æ¬¡'}}</view>
        </view>
        <view class="reminder-actions">
          <switch checked="{{item.enabled}}" bindchange="onToggle" data-id="{{item.id}}" color="#f97316" />
          <view class="delete-btn" bindtap="onDelete" data-id="{{item.id}}">åˆ é™¤</view>
        </view>
      </view>
    </view>
    <view class="empty-hint" wx:else>æš‚æ— ç”¨è¯æé†’</view>
  </view>

  <!-- ä½“æ£€æé†’ -->
  <view class="section">
    <view class="section-header">
      <text class="section-icon">ğŸ¥</text>
      <text class="section-title">ä½“æ£€æé†’</text>
    </view>
    <view class="reminder-list" wx:if="{{checkupReminders.length > 0}}">
      <view class="reminder-item" wx:for="{{checkupReminders}}" wx:key="id">
        <view class="reminder-info">
          <view class="reminder-time">{{item.date}} {{item.time}}</view>
          <view class="reminder-detail">
            <text class="reminder-title">{{item.title}}</text>
            <text class="reminder-pet" wx:if="{{item.petName}}">Â· {{item.petName}}</text>
          </view>
        </view>
        <view class="reminder-actions">
          <switch checked="{{item.enabled}}" bindchange="onToggle" data-id="{{item.id}}" color="#f97316" />
          <view class="delete-btn" bindtap="onDelete" data-id="{{item.id}}">åˆ é™¤</view>
        </view>
      </view>
    </view>
    <view class="empty-hint" wx:else>æš‚æ— ä½“æ£€æé†’</view>
  </view>

  <!-- æ·»åŠ æŒ‰é’® -->
  <view class="add-btn-wrap">
    <button class="add-btn" bindtap="showAdd">+ æ·»åŠ æé†’</button>
  </view>

  <!-- æ·»åŠ å¼¹çª— -->
  <view class="modal-mask" wx:if="{{showAddModal}}" catchtap="hideAdd">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">æ·»åŠ æé†’</text>
        <text class="modal-close" catchtap="hideAdd">âœ•</text>
      </view>

      <!-- ç±»å‹é€‰æ‹© -->
      <view class="form-group">
        <view class="form-label">æé†’ç±»å‹</view>
        <view class="type-options">
          <view
            class="type-option {{newReminder.type === item.id ? 'active' : ''}}"
            wx:for="{{typeOptions}}"
            wx:key="id"
            data-type="{{item.id}}"
            catchtap="onTypeChange"
          >
            <text class="type-icon">{{item.icon}}</text>
            <text class="type-name">{{item.name}}</text>
          </view>
        </view>
      </view>

      <!-- é€‰æ‹©å® ç‰© -->
      <view class="form-group" wx:if="{{pets.length > 0}}">
        <view class="form-label">é€‰æ‹©å® ç‰©</view>
        <picker mode="selector" range="{{pets}}" range-key="name" bindchange="onPetChange">
          <view class="picker-value">
            {{selectedPetName || (pets[0] && pets[0].name) || 'è¯·é€‰æ‹©'}}
            <text class="picker-arrow">â€º</text>
          </view>
        </picker>
      </view>

      <!-- æé†’å†…å®¹ -->
      <view class="form-group">
        <view class="form-label">æé†’å†…å®¹</view>
        <input
          class="form-input"
          placeholder="å¦‚ï¼šè¯¥å–‚é¥­å•¦"
          value="{{newReminder.title}}"
          bindinput="onTitleInput"
          catchtap="stopPropagation"
        />
      </view>

      <!-- æ—¥æœŸé€‰æ‹©ï¼ˆä½“æ£€ï¼‰ -->
      <view class="form-group" wx:if="{{newReminder.type === 'checkup'}}">
        <view class="form-label">ä½“æ£€æ—¥æœŸ</view>
        <picker mode="date" value="{{newReminder.date}}" bindchange="onDateChange">
          <view class="picker-value">
            {{newReminder.date}}
            <text class="picker-arrow">â€º</text>
          </view>
        </picker>
      </view>

      <!-- æ—¶é—´é€‰æ‹© -->
      <view class="form-group">
        <view class="form-label">æé†’æ—¶é—´</view>
        <picker mode="time" value="{{newReminder.time}}" bindchange="onTimeChange">
          <view class="picker-value">
            {{newReminder.time}}
            <text class="picker-arrow">â€º</text>
          </view>
        </picker>
      </view>

      <!-- é‡å¤ï¼ˆå–‚é£Ÿ/ç”¨è¯ï¼‰ -->
      <view class="form-group" wx:if="{{newReminder.type !== 'checkup'}}">
        <view class="form-label">é‡å¤</view>
        <picker mode="selector" range="{{repeatOptions}}" range-key="name" bindchange="onRepeatChange">
          <view class="picker-value">
            {{newReminder.repeat === 'daily' ? 'æ¯å¤©' : 'ä»…ä¸€æ¬¡'}}
            <text class="picker-arrow">â€º</text>
          </view>
        </picker>
      </view>

      <!-- ä¿å­˜æŒ‰é’® -->
      <button class="save-btn" catchtap="saveReminder">ä¿å­˜</button>
    </view>
  </view>
</view>
