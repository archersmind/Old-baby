<!--pages/index/index.wxml-->
<view class="container page-gradient-bg">
  <!-- 顶部标题 -->
  <view class="page-header">
    <view class="header-title">我的宝贝</view>
    <view class="header-subtitle">用爱守护每一天</view>
  </view>

  <!-- 今日提醒 -->
  <view class="reminder-section" wx:if="{{todayReminders.length > 0}}">
    <view class="reminder-header">
      <text class="reminder-title">🔔 今日提醒</text>
      <text class="reminder-more" bindtap="goReminders">管理 ›</text>
    </view>
    <view class="reminder-cards">
      <view class="reminder-card {{item.type}}" wx:for="{{todayReminders}}" wx:key="id">
        <view class="reminder-card-icon">
          {{item.type === 'feeding' ? '🍽' : item.type === 'medication' ? '💊' : '🏥'}}
        </view>
        <view class="reminder-card-info">
          <view class="reminder-card-title">{{item.title}}</view>
          <view class="reminder-card-detail">
            {{item.type === 'checkup' ? item.date : item.time}}
            <text wx:if="{{item.petName}}"> · {{item.petName}}</text>
          </view>
        </view>
        <view class="reminder-card-done" bindtap="onReminderDone" data-id="{{item.id}}">完成</view>
      </view>
    </view>
  </view>

  <!-- 宠物列表 -->
  <view class="pet-list" wx:if="{{!isEmpty}}">
    <view class="pet-card" wx:for="{{pets}}" wx:key="id" bindtap="onPetTap" data-id="{{item.id}}">
      <view class="pet-avatar-wrap">
        <image
          class="pet-avatar"
          src="{{item.avatar}}"
          mode="aspectFill"
          wx:if="{{item.avatar}}"
        />
        <view class="pet-avatar-placeholder" wx:else>🐕</view>
      </view>
      <view class="pet-info">
        <view class="pet-name-row">
          <view class="pet-name">{{item.name || '未命名'}}</view>
          <view class="pet-chevron">›</view>
        </view>
        <view class="pet-breed-age">{{item.breedName || '未知品种'}} · {{item.age}}岁</view>
        <view class="pet-status-row">
          <view class="pet-health-status">
            <text class="status-icon">♥</text>
            <text class="{{item.isHealthComplete ? 'status-text-warning' : 'status-text-good'}}">{{item.isHealthComplete ? '需关注' : '良好'}}</text>
          </view>
          <view class="pet-checkup" wx:if="{{item.lastCheckupDate}}">
            <text class="checkup-icon">📅</text>
            <text class="checkup-text">{{item.lastCheckupDate}}</text>
          </view>
          <view class="pet-checkup-hint" wx:if="{{!item.lastCheckupDate}}">
            <text class="hint-icon">💡</text>
            <text class="hint-text">记得带TA体检哦</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 空状态 -->
  <view class="empty-state" wx:if="{{isEmpty}}">
    <view class="empty-icon-emoji">🐕</view>
    <view class="empty-text">还没有添加宠物</view>
    <view class="empty-hint">添加你的宝贝，获取专属食谱推荐</view>
  </view>

  <!-- 添加宠物按钮 -->
  <view class="add-btn-wrap">
    <button class="add-btn" bindtap="onAddPet">
      <text class="add-icon">+</text>
      <text>添加宠物档案</text>
    </button>
  </view>

  <!-- 健康管理小贴士 -->
  <view class="health-tip-card" wx:if="{{!isEmpty}}">
    <view class="tip-title">健康管理小贴士</view>
    <view class="tip-content">定期记录宠物的体重、饮食和运动情况，有助于及时发现健康问题。</view>
  </view>

  <!-- 底部占位 -->
  <view class="bottom-spacer"></view>

  <!-- 欢迎弹窗 -->
  <view class="welcome-mask" wx:if="{{showWelcome}}" bindtap="onCloseWelcome">
    <view class="welcome-card" catchtap="">
      <view class="welcome-header">
        <view class="welcome-title">欢迎使用 Old-baby</view>
        <view class="welcome-close" bindtap="onCloseWelcome">✕</view>
      </view>

      <view class="welcome-hero">
        <text class="welcome-paw">🐾</text>
        <text class="welcome-slogan">用爱守护每一天</text>
      </view>

      <view class="welcome-steps">
        <view class="welcome-step">
          <view class="step-circle orange">1</view>
          <view class="step-info">
            <view class="step-title">记录宠物档案</view>
            <view class="step-desc">详细记录宠物的健康状况、过敏史和用药情况</view>
          </view>
        </view>
        <view class="welcome-step">
          <view class="step-circle pink">2</view>
          <view class="step-info">
            <view class="step-title">获取智能食谱</view>
            <view class="step-desc">根据宠物健康情况，推荐个性化营养食谱</view>
          </view>
        </view>
        <view class="welcome-step">
          <view class="step-circle blue">3</view>
          <view class="step-info">
            <view class="step-title">本地数据存储</view>
            <view class="step-desc">所有信息都保存在您的设备上，保护隐私</view>
          </view>
        </view>
      </view>

      <button class="welcome-btn" bindtap="onCloseWelcome">开始使用</button>
    </view>
  </view>
</view>
